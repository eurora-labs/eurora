syntax = "proto3";

package agent_chain;

message ProtoChatRequest {
  string conversation_id = 1;
  repeated ProtoBaseMessage messages = 2;
  ProtoParameters parameters = 3;
}

message ProtoChatResponse {
  ProtoAIMessage message = 1;
  optional ProtoUsageMetadata usage = 2;
  optional string stop_reason = 3;
}

message ProtoChatStreamResponse {
  ProtoAIMessageChunk chunk = 1;
  bool is_final = 2;
}

message ProtoBaseMessage {
  oneof message {
    ProtoHumanMessage human = 1;
    ProtoSystemMessage system = 2;
    ProtoAIMessage ai = 3;
    ProtoToolMessage tool = 4;
    ProtoChatMessage chat = 5;
    ProtoFunctionMessage function = 6;
    ProtoRemoveMessage remove = 7;
  }
}

message ProtoBaseMessageChunk {
  oneof chunk {
    ProtoAIMessageChunk ai = 1;
    ProtoHumanMessageChunk human = 2;
    ProtoSystemMessageChunk system = 3;
    ProtoToolMessageChunk tool = 4;
    ProtoChatMessageChunk chat = 5;
    ProtoFunctionMessageChunk function = 6;
  }
}

message ProtoHumanMessage {
  ProtoMessageContent content = 1;
  optional string id = 2;
  optional string name = 3;
  optional string additional_kwargs = 4;
}

message ProtoHumanMessageChunk {
  ProtoMessageContent content = 1;
  optional string id = 2;
  optional string name = 3;
  optional string additional_kwargs = 4;
  optional string response_metadata = 5;
}

message ProtoSystemMessage {
  ProtoMessageContent content = 1;
  optional string id = 2;
  optional string name = 3;
  optional string additional_kwargs = 4;
}

message ProtoSystemMessageChunk {
  ProtoMessageContent content = 1;
  optional string id = 2;
  optional string name = 3;
  optional string additional_kwargs = 4;
  optional string response_metadata = 5;
}

message ProtoAIMessage {
  ProtoMessageContent content = 1;
  optional string id = 2;
  optional string name = 3;
  repeated ProtoToolCall tool_calls = 4;
  repeated ProtoInvalidToolCall invalid_tool_calls = 5;
  optional ProtoUsageMetadata usage_metadata = 6;
  optional string additional_kwargs = 7;
  optional string response_metadata = 8;
}

message ProtoAIMessageChunk {
  ProtoMessageContent content = 1;
  optional string id = 2;
  optional string name = 3;
  repeated ProtoToolCall tool_calls = 4;
  repeated ProtoInvalidToolCall invalid_tool_calls = 5;
  repeated ProtoToolCallChunk tool_call_chunks = 6;
  optional ProtoUsageMetadata usage_metadata = 7;
  optional string additional_kwargs = 8;
  optional string response_metadata = 9;
  optional ProtoChunkPosition chunk_position = 10;
}

enum ProtoChunkPosition {
  CHUNK_POSITION_UNSPECIFIED = 0;
  CHUNK_POSITION_LAST = 1;
}

message ProtoToolMessage {
  ProtoMessageContent content = 1;
  string tool_call_id = 2;
  optional string id = 3;
  optional string name = 4;
  ProtoToolStatus status = 5;
  optional string artifact = 6;
  optional string additional_kwargs = 7;
  optional string response_metadata = 8;
}

message ProtoToolMessageChunk {
  ProtoMessageContent content = 1;
  string tool_call_id = 2;
  optional string id = 3;
  optional string name = 4;
  ProtoToolStatus status = 5;
  optional string artifact = 6;
  optional string additional_kwargs = 7;
  optional string response_metadata = 8;
}

enum ProtoToolStatus {
  TOOL_STATUS_UNSPECIFIED = 0;
  TOOL_STATUS_SUCCESS = 1;
  TOOL_STATUS_ERROR = 2;
}

message ProtoChatMessage {
  ProtoMessageContent content = 1;
  string role = 2;
  optional string id = 3;
  optional string name = 4;
  optional string additional_kwargs = 5;
  optional string response_metadata = 6;
}

message ProtoChatMessageChunk {
  ProtoMessageContent content = 1;
  string role = 2;
  optional string id = 3;
  optional string name = 4;
  optional string additional_kwargs = 5;
  optional string response_metadata = 6;
}

// Deprecated: use ToolMessage instead
message ProtoFunctionMessage {
  ProtoMessageContent content = 1;
  string name = 2;
  optional string id = 3;
  optional string additional_kwargs = 4;
  optional string response_metadata = 5;
}

// Deprecated: use ToolMessage instead
message ProtoFunctionMessageChunk {
  ProtoMessageContent content = 1;
  string name = 2;
  optional string id = 3;
  optional string additional_kwargs = 4;
  optional string response_metadata = 5;
}

message ProtoRemoveMessage {
  string id = 1;
}

message ProtoMessageContent {
  oneof content {
    string text = 1;
    ProtoContentParts parts = 2;
  }
}

message ProtoContentParts {
  repeated ProtoContentPart parts = 1;
}

message ProtoContentPart {
  oneof part {
    ProtoTextPart text = 1;
    ProtoImagePart image = 2;
  }
}

message ProtoTextPart {
  string text = 1;
}

message ProtoImagePart {
  ProtoImageSource source = 1;
  optional ProtoImageDetail detail = 2;
}

message ProtoImageSource {
  oneof source {
    string url = 1;
    ProtoBase64Image base64 = 2;
  }
}

message ProtoBase64Image {
  string media_type = 1;
  string data = 2;
}

enum ProtoImageDetail {
  IMAGE_DETAIL_UNSPECIFIED = 0;
  IMAGE_DETAIL_LOW = 1;
  IMAGE_DETAIL_HIGH = 2;
  IMAGE_DETAIL_AUTO = 3;
}

message ProtoContentBlock {
  oneof block {
    ProtoTextContentBlock text = 1;
    ProtoInvalidToolCallBlock invalid_tool_call = 2;
    ProtoReasoningContentBlock reasoning = 3;
    ProtoNonStandardContentBlock non_standard = 4;
    ProtoImageContentBlock image = 5;
    ProtoVideoContentBlock video = 6;
    ProtoAudioContentBlock audio = 7;
    ProtoPlainTextContentBlock plain_text = 8;
    ProtoFileContentBlock file = 9;
    ProtoToolCallBlock tool_call = 10;
    ProtoToolCallChunkBlock tool_call_chunk = 11;
    ProtoServerToolCall server_tool_call = 12;
    ProtoServerToolCallChunk server_tool_call_chunk = 13;
    ProtoServerToolResult server_tool_result = 14;
  }
}

message ProtoTextContentBlock {
  optional string id = 1;
  string text = 2;
  repeated ProtoAnnotation annotations = 3;
  optional ProtoBlockIndex index = 4;
  optional string extras = 5;
}

message ProtoReasoningContentBlock {
  optional string id = 1;
  optional string reasoning = 2;
  optional ProtoBlockIndex index = 3;
  optional string extras = 4;
}

message ProtoImageContentBlock {
  optional string id = 1;
  optional string file_id = 2;
  optional string mime_type = 3;
  optional ProtoBlockIndex index = 4;
  optional string url = 5;
  optional string base64 = 6;
  optional string extras = 7;
}

message ProtoVideoContentBlock {
  optional string id = 1;
  optional string file_id = 2;
  optional string mime_type = 3;
  optional ProtoBlockIndex index = 4;
  optional string url = 5;
  optional string base64 = 6;
  optional string extras = 7;
}

message ProtoAudioContentBlock {
  optional string id = 1;
  optional string file_id = 2;
  optional string mime_type = 3;
  optional ProtoBlockIndex index = 4;
  optional string url = 5;
  optional string base64 = 6;
  optional string extras = 7;
}

message ProtoPlainTextContentBlock {
  optional string id = 1;
  optional string file_id = 2;
  string mime_type = 3;
  optional ProtoBlockIndex index = 4;
  optional string url = 5;
  optional string base64 = 6;
  optional string text = 7;
  optional string title = 8;
  optional string context = 9;
  optional string extras = 10;
}

message ProtoFileContentBlock {
  optional string id = 1;
  optional string file_id = 2;
  optional string mime_type = 3;
  optional ProtoBlockIndex index = 4;
  optional string url = 5;
  optional string base64 = 6;
  optional string extras = 7;
}

message ProtoNonStandardContentBlock {
  optional string id = 1;
  string value = 2;
  optional ProtoBlockIndex index = 3;
}

message ProtoBlockIndex {
  oneof index {
    int64 int_index = 1;
    string str_index = 2;
  }
}

message ProtoAnnotation {
  oneof annotation {
    ProtoCitation citation = 1;
    ProtoNonStandardAnnotation non_standard = 2;
  }
}

message ProtoCitation {
  optional string id = 1;
  optional string url = 2;
  optional string title = 3;
  optional int64 start_index = 4;
  optional int64 end_index = 5;
  optional string cited_text = 6;
  optional string extras = 7;
}

message ProtoNonStandardAnnotation {
  optional string id = 1;
  string value = 2;
}

message ProtoToolCall {
  string id = 1;
  string name = 2;
  string args = 3;
}

message ProtoToolCallChunk {
  optional string name = 1;
  optional string args = 2;
  optional string id = 3;
  optional int32 index = 4;
}

message ProtoInvalidToolCall {
  optional string name = 1;
  optional string args = 2;
  optional string id = 3;
  optional string error = 4;
}

message ProtoToolCallBlock {
  optional string id = 1;
  string name = 2;
  string args = 3;
  optional ProtoBlockIndex index = 4;
  optional string extras = 5;
}

message ProtoToolCallChunkBlock {
  optional string id = 1;
  optional string name = 2;
  optional string args = 3;
  optional ProtoBlockIndex index = 4;
  optional string extras = 5;
}

message ProtoInvalidToolCallBlock {
  optional string id = 1;
  optional string name = 2;
  optional string args = 3;
  optional string error = 4;
  optional ProtoBlockIndex index = 5;
  optional string extras = 6;
}

message ProtoServerToolCall {
  string id = 1;
  string name = 2;
  string args = 3;
  optional ProtoBlockIndex index = 4;
  optional string extras = 5;
}

message ProtoServerToolCallChunk {
  optional string name = 1;
  optional string args = 2;
  optional string id = 3;
  optional ProtoBlockIndex index = 4;
  optional string extras = 5;
}

enum ProtoServerToolStatus {
  SERVER_TOOL_STATUS_UNSPECIFIED = 0;
  SERVER_TOOL_STATUS_SUCCESS = 1;
  SERVER_TOOL_STATUS_ERROR = 2;
}

message ProtoServerToolResult {
  optional string id = 1;
  string tool_call_id = 2;
  ProtoServerToolStatus status = 3;
  optional string output = 4;
  optional ProtoBlockIndex index = 5;
  optional string extras = 6;
}

message ProtoUsageMetadata {
  int64 input_tokens = 1;
  int64 output_tokens = 2;
  int64 total_tokens = 3;
  optional ProtoInputTokenDetails input_token_details = 4;
  optional ProtoOutputTokenDetails output_token_details = 5;
}

message ProtoInputTokenDetails {
  optional int64 audio = 1;
  optional int64 cache_creation = 2;
  optional int64 cache_read = 3;
}

message ProtoOutputTokenDetails {
  optional int64 audio = 1;
  optional int64 reasoning = 2;
}

message ProtoParameters {
  optional float temperature = 1;
  optional uint32 max_tokens = 2;
  optional float top_p = 3;
  optional uint32 top_k = 4;
  repeated string stop_sequences = 5;
  optional float frequency_penalty = 6;
  optional float presence_penalty = 7;
}

message ProtoChatResult {
  repeated ProtoChatGeneration generations = 1;
  optional string llm_output = 2;
}

message ProtoChatGeneration {
  string text = 1;
  ProtoBaseMessage message = 2;
  optional string generation_info = 3;
}

message ProtoChatGenerationChunk {
  string text = 1;
  ProtoBaseMessageChunk message = 2;
  optional string generation_info = 3;
}
