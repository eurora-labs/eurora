<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Fragment>
        <!-- Define the directory structure for C:\Program Files\Eurora Labs\Eurora\ -->
        <DirectoryRef Id="TARGETDIR">
            <!-- <Directory Id="ProgramFiles64Folder"> -->
                <Directory Id="EuroraLabsFolder" Name="Eurora Labs">
                    <Directory Id="EuroraFolder" Name="Eurora">
                        <Directory Id="ChromeFolder" Name="chrome">
                            <!-- Component to copy the native-messaging-host.json file to the target location -->
                            <Component Id="ChromeNativeMessagingHostJson" Guid="8c7ca6a7-77b0-4738-aaa5-9ba9b4a509fe">
                                <File Id="ChromeNativeMessagingHostJsonFile"
                                    Name="com.eurora.app.json"
                                    Source="D:\a\eurora\eurora\crates\app\euro-tauri\hosts\windows.chromium.native-messaging.json"
                                KeyPath="yes" />
                            </Component>
                            <Component Id="ChromeNativeMessaging" Guid="6adc0a23-d076-44c8-8a93-e22934856bac">
                                <File Id="ChromeNativeMessagingFile"
                                    Name="euro-native-messaging.exe"
                                    Source="D:\a\eurora\eurora\target\release\euro-native-messaging.exe"
                                    KeyPath="yes" />
                            </Component>
                        </Directory>

                        <Directory Id="EdgeFolder" Name="edge">
                            <Component Id="EdgeNativeMessagingHostJson" Guid="a1f3b2c4-5d6e-7f80-9a1b-2c3d4e5f6a7b">
                                <File Id="EdgeNativeMessagingHostJsonFile"
                                    Name="com.eurora.app.json"
                                    Source="D:\a\eurora\eurora\crates\app\euro-tauri\hosts\windows.edge.native-messaging.json"
                                    KeyPath="yes" />
                            </Component>
                            <Component Id="EdgeNativeMessaging" Guid="b2c3d4e5-6f7a-8b9c-0d1e-2f3a4b5c6d7e">
                                <File Id="EdgeNativeMessagingFile"
                                    Name="euro-native-messaging.exe"
                                    Source="D:\a\eurora\eurora\target\release\euro-native-messaging.exe"
                                    KeyPath="yes" />
                            </Component>
                        </Directory>

                        <Directory Id="FirefoxFolder" Name="firefox">
                            <Component Id="FirefoxNativeMessagingHostJson" Guid="b4e02a43-35e2-4635-b980-9b87224a33b1">
                                <File Id="FirefoxNativeMessagingHostJsonFile"
                                    Name="com.eurora.app.json"
                                    Source="D:\a\eurora\eurora\crates\app\euro-tauri\hosts\windows.firefox.native-messaging.json"
                                    KeyPath="yes" />
                            </Component>
                            <Component Id="FirefoxNativeMessaging" Guid="93829cc0-4c70-4684-9cab-79f0cad6ed9d">
                                <File Id="FirefoxNativeMessagingFile"
                                    Name="euro-native-messaging.exe"
                                    Source="D:\a\eurora\eurora\target\release\euro-native-messaging.exe"
                                    KeyPath="yes" />
                            </Component>
                        </Directory>
                    </Directory>
                </Directory>
            <!-- </Directory> -->

            <!-- Registry component -->
            <Component Id="ChromeRegistryEntries" Guid="*">
                <RegistryKey
                Root="HKCU"
                Key="Software\Google\Chrome\NativeMessagingHosts\com.eurora.app"
                Action="createAndRemoveOnUninstall"
                >
                    <!-- values to persist on the registry -->
                    <RegistryValue
                        Type="string"
                        Value="C:\\Eurora Labs\\Eurora\\chrome\\com.eurora.app.json"
                        KeyPath="yes"
                    />
                </RegistryKey>
            </Component>
            <Component Id="EdgeRegistryEntries" Guid="*">
                <RegistryKey
                Root="HKCU"
                Key="Software\Microsoft\Edge\NativeMessagingHosts\com.eurora.app"
                Action="createAndRemoveOnUninstall"
                >
                    <RegistryValue
                        Type="string"
                        Value="C:\\Eurora Labs\\Eurora\\edge\\com.eurora.app.json"
                        KeyPath="yes"
                    />
                </RegistryKey>
            </Component>
            <Component Id="FirefoxRegistryEntries" Guid="*">
                <RegistryKey
                Root="HKCU"
                Key="Software\Mozilla\NativeMessagingHosts\com.eurora.app"
                Action="createAndRemoveOnUninstall"
                >
                    <!-- values to persist on the registry -->
                    <RegistryValue
                        Type="string"
                        Value="C:\\Eurora Labs\\Eurora\\firefox\\com.eurora.app.json"
                        KeyPath="yes"
                    />
                </RegistryKey>
            </Component>
        </DirectoryRef>


    </Fragment>
</Wix>
